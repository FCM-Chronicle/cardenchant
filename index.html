<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FC 모바일 강화 시뮬레이션</title>
    <link rel="stylesheet" href="style.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-image: url('https://www.dropbox.com/scl/fi/i73un0sdokgxtjb4rd5gi/.png?rlkey=nv6ryg9afh1far1tq89g35ayc&st=5qkcezcp&raw=1');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-attachment: fixed;
        }

        .container {
            text-align: center;
            max-width: 400px;
            width: 100%;
        }

        .card {
            position: relative;
            margin-bottom: 30px;
            width: 320px;
            height: 320px;
            margin: 0 auto 30px;
        }

        .image {
            width: 100%;
            height: 100%;
            object-fit: contain; /* 전체 이미지가 보이도록 변경 */
        }

        .toti {
            position: absolute;
            /* 기본 위치를 살짝 위로, 왼쪽으로 조정 */
            top: 80%;
            left: 63%;
            transform: translate(-50%, -50%);
            transition: opacity 0.1s ease-in-out;
            width: 12%; /* 토티일 때 작은 크기 */
            height: auto;
        }

        .toti.enhanced {
            width: 15.5%; /* 강화 상태일 때 원래 크기 */
        }

        .controls {
            display: flex;
            flex-direction: column;
            gap: 15px;
            align-items: center;
        }

        select, button {
            padding: 12px 20px;
            font-size: 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
        }

        input[type="checkbox"] {
            transform: scale(1.2);
        }

        /* 로딩 표시 */
        .loading {
            opacity: 0.7;
            pointer-events: none;
        }

        .success-effect {
            animation: successGlow 0.5s ease-out;
        }

        .fail-effect {
            animation: failShake 0.5s ease-out;
        }

        @keyframes successGlow {
            0% { filter: brightness(1); }
            50% { filter: brightness(1.3) drop-shadow(0 0 10px #00ff00); }
            100% { filter: brightness(1); }
        }

        @keyframes failShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="card" id="card">
            <img src="https://www.dropbox.com/scl/fi/bjzvly49t75x7nuzqjzdh/1722659085642.png?rlkey=vxmhz6rhxtpbnjk2wrwn2t75n&st=h24wo6ab&raw=1" alt="기본 이미지" class="image">
            <img src="https://www.dropbox.com/scl/fi/sedc3pc3jrzw9gddrj03g/.png?rlkey=4i800pev6ugy9tas5htmzx3ph&st=sln56ut1&raw=1" alt="토티" class="toti" id="toti">
        </div>

        <div class="controls">
            <select id="enhancementLevel" onchange="updateImage()">
                <option value="0">도전할 강화 단계 선택</option>
                <option value="1">1강</option>
                <option value="2">2강</option>
                <option value="3">3강</option>
                <option value="4">4강</option>
                <option value="5">5강</option>
                <option value="6">6강</option>
                <option value="7">7강</option>
                <option value="8">8강</option>
                <option value="9">9강</option>
                <option value="10">10강</option>
            </select>

            <button id="enhanceButton" onclick="enhance()">강화 시도</button>
            <label>
                <input type="checkbox" id="fixedCheckbox"> 강화 실패 시 유지
            </label>
        </div>
    </div>

    <script>
        const successRates = {
            1: 100,
            2: 81,
            3: 81,
            4: 61,
            5: 61,
            6: 41,
            7: 41,
            8: 41,
            9: 35,
            10: 30
        };

        const imageLinks = {
            1: 'https://www.dropbox.com/scl/fi/fhpw9sl2ua87fldvo60gd/1.png?rlkey=r515nvwx19y56jvkvsaq82si8&st=tghyci0i&raw=1',
            2: 'https://www.dropbox.com/scl/fi/kpsl72sj04uu2no6rptgu/2.png?rlkey=wscx11lkyaqctfehbrlxgzjai&st=fujeg7iq&raw=1',
            3: 'https://www.dropbox.com/scl/fi/jr6qzunups805rqbmqwmr/3.png?rlkey=9w8dfyr5jp04pxwj187pzevt9&st=5jusuxfc&raw=1',
            4: 'https://www.dropbox.com/scl/fi/kj7ky2hytwthdcpnkz68s/4.png?rlkey=fotrs7rfd28bn4ichmax56cpw&st=sfovb4y4&raw=1',
            5: 'https://www.dropbox.com/scl/fi/nse3bm0lunb85qiby35d5/5.png?rlkey=8sdqen5fey301avnmmj28bqri&st=t77q0htz&raw=1',
            6: 'https://www.dropbox.com/scl/fi/33b2lgr3r4a4ncgkxtt1s/6.png?rlkey=2awc7ognxqakq8yio8c83jans&st=7k5vbt5n&raw=1',
            7: 'https://www.dropbox.com/scl/fi/i6wehbygpl5brnlyt6hpo/7.png?rlkey=r3r3wu6q7ea1v48z43hu6djja&st=fbq01utg&raw=1',
            8: 'https://www.dropbox.com/scl/fi/okdwebp4ueerkqjwjv2sj/8.png?rlkey=fws9c0gu7fyrz5damthty71nf&st=kl4lu5cp&raw=1',
            9: 'https://www.dropbox.com/scl/fi/ioy67t26bdd6chaiyf5gm/9.png?rlkey=jgozllflp13vchvtwj68y4hy9&st=hc54mfre&raw=1',
            10: 'https://www.dropbox.com/scl/fi/hwtpznjbw3xblchpnwlu2/10.png?rlkey=fwunvuh91hfzqq8hfb1etlet2&st=e60lah03&raw=1'
        };

        // 이미지 미리 로드를 위한 객체 생성
        const preloadedImages = {};
        
        // 페이지 로드 시 모든 이미지를 미리 로드
        window.addEventListener('load', function() {
            for (let level in imageLinks) {
                const img = new Image();
                img.src = imageLinks[level];
                preloadedImages[level] = img;
            }
        });

        function updateImage() {
            const levelSelect = document.getElementById('enhancementLevel');
            const selectedLevel = parseInt(levelSelect.value);
            const totiImage = document.getElementById('toti');

            if (selectedLevel > 1) {
                const previousLevel = selectedLevel - 1;
                changeImageFast(totiImage, imageLinks[previousLevel]);
            } else if (selectedLevel === 1) {
                changeImageFast(totiImage, imageLinks[1]);
            } else {
                changeImageFast(totiImage, 'https://www.dropbox.com/scl/fi/sedc3pc3jrzw9gddrj03g/.png?rlkey=4i800pev6ugy9tas5htmzx3ph&st=sln56ut1&raw=1');
            }
        }

        // 빠른 이미지 변경 함수
        function changeImageFast(imgElement, newSrc) {
            // 미리 로드된 이미지가 있다면 즉시 변경
            imgElement.style.opacity = '0';
            setTimeout(() => {
                imgElement.src = newSrc;
                
                // 토티인지 강화 상태인지 확인해서 클래스 추가/제거
                if (newSrc.includes('sedc3pc3jrzw9gddrj03g')) {
                    // 토티 기본 이미지
                    imgElement.classList.remove('enhanced');
                } else {
                    // 강화 이미지
                    imgElement.classList.add('enhanced');
                }
                
                imgElement.style.opacity = '1';
            }, 50);
        }

        function enhance() {
            const levelSelect = document.getElementById('enhancementLevel');
            let selectedLevel = parseInt(levelSelect.value);
            const fixedCheckbox = document.getElementById('fixedCheckbox');
            const card = document.getElementById('card');
            const enhanceButton = document.getElementById('enhanceButton');

            if (selectedLevel === 0) {
                return;
            }

            // 버튼 비활성화
            enhanceButton.disabled = true;
            enhanceButton.textContent = '강화 중...';

            const successRate = successRates[selectedLevel];
            const randomValue = Math.random() * 100;

            // 짧은 지연 후 결과 처리 (애니메이션 효과)
            setTimeout(() => {
                if (randomValue < successRate) {
                    // 강화 성공
                    card.classList.add('success-effect');
                    const imageLink = imageLinks[selectedLevel];
                    changeImageFast(document.getElementById('toti'), imageLink);
                    selectedLevel = Math.min(selectedLevel + 1, 10);
                    levelSelect.value = selectedLevel;

                    if (selectedLevel === 11) {
                        enhanceButton.textContent = '초기화';
                        enhanceButton.setAttribute('onclick', 'resetGame()');
                    }
                } else {
                    // 강화 실패
                    card.classList.add('fail-effect');
                    if (!fixedCheckbox.checked) {
                        const newLevel = Math.max(selectedLevel - 2, 1);
                        const previousLevel = Math.max(selectedLevel - 1, 1);
                        changeImageFast(document.getElementById('toti'), imageLinks[newLevel]);
                        levelSelect.value = previousLevel;
                    }
                }

                // 애니메이션 효과 제거 및 버튼 재활성화
                setTimeout(() => {
                    card.classList.remove('success-effect', 'fail-effect');
                    enhanceButton.disabled = false;
                    if (enhanceButton.textContent === '강화 중...') {
                        enhanceButton.textContent = '강화 시도';
                    }
                }, 500);
            }, 100);
        }

        function resetGame() {
            if (confirm("진짜 초기화 하시겠습니까?")) {
                const levelSelect = document.getElementById('enhancementLevel');
                levelSelect.value = 0;
                changeImageFast(document.getElementById('toti'), 'https://www.dropbox.com/scl/fi/sedc3pc3jrzw9gddrj03g/.png?rlkey=4i800pev6ugy9tas5htmzx3ph&st=sln56ut1&raw=1');
                const enhanceButton = document.getElementById('enhanceButton');
                enhanceButton.textContent = '강화 시도';
                enhanceButton.setAttribute('onclick', 'enhance()');
            }
        }
    </script>
    <div style="position: fixed; bottom: 10px; right: 10px; color: #666; font-size: 12px;">
        made by Fcm(이하준)
    </div>
</body>
</html>
